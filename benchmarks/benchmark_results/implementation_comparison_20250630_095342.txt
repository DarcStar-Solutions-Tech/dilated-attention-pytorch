Benchmark Results - 20250630_095342
Device: cuda, Dtype: torch.float32

+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| Implementation     |   Batch |   Seq Len |   Heads | Time (ms)   | Memory (MB)   | Throughput (tok/s)   | Status   |
+====================+=========+===========+=========+=============+===============+======================+==========+
| standard           |       1 |      1024 |       8 | 1.16        | 29.03         | 882025               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       1 |      1024 |      16 | 1.84        | 49.03         | 555348               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       1 |      2048 |       8 | 3.30        | 49.03         | 621503               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       1 |      2048 |      16 | 5.79        | 89.03         | 353782               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       1 |      4096 |       8 | 10.46       | 89.03         | 391549               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       1 |      4096 |      16 | 42.82       | 169.03        | 95652                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       2 |      1024 |       8 | 4.76        | 48.03         | 430075               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       2 |      1024 |      16 | 13.34       | 89.03         | 153478               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       2 |      2048 |       8 | 36.91       | 89.03         | 110960               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       2 |      2048 |      16 | 11.62       | 169.03        | 352542               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       2 |      4096 |       8 | 121.90      | 169.03        | 67201                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       2 |      4096 |      16 | 197.12      | 328.03        | 41559                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       4 |      1024 |       8 | 6.02        | 89.03         | 680418               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       4 |      1024 |      16 | 21.67       | 169.03        | 189060               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       4 |      2048 |       8 | 74.54       | 169.03        | 109906               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       4 |      2048 |      16 | 147.86      | 328.03        | 55403                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       4 |      4096 |       8 | 200.98      | 328.03        | 81520                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| standard           |       4 |      4096 |      16 | 425.72      | 648.03        | 38486                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       1 |      1024 |       8 | 0.71        | 25.03         | 1438245              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       1 |      1024 |      16 | 0.71        | 41.03         | 1452213              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       1 |      2048 |       8 | 1.07        | 41.03         | 1908917              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       1 |      2048 |      16 | 1.22        | 73.03         | 1672366              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       1 |      4096 |       8 | 15.29       | 73.03         | 267905               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       1 |      4096 |      16 | 31.62       | 137.03        | 129540               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       2 |      1024 |       8 | 6.13        | 40.03         | 334128               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       2 |      1024 |      16 | 6.52        | 73.03         | 314020               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       2 |      2048 |       8 | 2.52        | 73.03         | 1627541              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       2 |      2048 |      16 | 2.03        | 137.03        | 2021527              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       2 |      4096 |       8 | 3.64        | 137.03        | 2250618              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       2 |      4096 |      16 | 3.91        | 264.03        | 2096991              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       4 |      1024 |       8 | 1.82        | 73.03         | 2248821              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       4 |      1024 |      16 | 1.83        | 137.03        | 2236676              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       4 |      2048 |       8 | 3.14        | 137.03        | 2605245              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       4 |      2048 |      16 | 3.78        | 264.03        | 2167614              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       4 |      4096 |       8 | 14.75       | 264.03        | 1110661              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| improved           |       4 |      4096 |      16 | 9.81        | 520.03        | 1669414              | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       1 |      1024 |       8 | 1.97        | 43.16         | 518987               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       1 |      1024 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       1 |      2048 |       8 | 6.20        | 69.16         | 330243               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       1 |      2048 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       1 |      4096 |       8 | 13.81       | 121.16        | 296580               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       1 |      4096 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       2 |      1024 |       8 | 7.47        | 69.16         | 274158               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       2 |      1024 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       2 |      2048 |       8 | 26.03       | 121.16        | 157347               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       2 |      2048 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       2 |      4096 |       8 | 122.79      | 225.16        | 66715                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       2 |      4096 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       4 |      1024 |       8 | 11.07       | 121.16        | 370019               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       4 |      1024 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       4 |      2048 |       8 | 48.73       | 225.16        | 168104               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       4 |      2048 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       4 |      4096 |       8 | 83.14       | 432.16        | 197071               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_standard |       4 |      4096 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       1 |      1024 |       8 | 2.18        | 57.16         | 470397               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       1 |      1024 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       1 |      2048 |       8 | 7.34        | 101.16        | 279176               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       1 |      2048 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       1 |      4096 |       8 | 22.87       | 185.16        | 179138               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       1 |      4096 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       2 |      1024 |       8 | 44.29       | 97.16         | 46243                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       2 |      1024 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       2 |      2048 |       8 | 36.99       | 185.16        | 110741               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       2 |      2048 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       2 |      4096 |       8 | 88.70       | 353.16        | 92353                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       2 |      4096 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       4 |      1024 |       8 | 20.28       | 177.16        | 201946               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       4 |      1024 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       4 |      2048 |       8 | 138.04      | 353.16        | 59347                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       4 |      2048 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       4 |      4096 |       8 | 169.74      | 688.16        | 96523                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| multihead_improved |       4 |      4096 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       1 |      1024 |       8 | 3.53        | 96.16         | 289929               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       1 |      1024 |      16 | 21.20       | 177.16        | 48295                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       1 |      2048 |       8 | 23.04       | 305.16        | 88886                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       1 |      2048 |      16 | 26.75       | 593.16        | 76573                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       1 |      4096 |       8 | 36.03       | 1105.16       | 113677               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       1 |      4096 |      16 | 212.71      | 2193.16       | 19256                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       2 |      1024 |       8 | 14.04       | 181.16        | 145883               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       2 |      1024 |      16 | 29.66       | 345.16        | 69053                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       2 |      2048 |       8 | 39.67       | 601.16        | 103252               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       2 |      2048 |      16 | 128.81      | 1185.16       | 31798                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       2 |      4096 |       8 | 189.47      | 2209.16       | 43237                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       2 |      4096 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       4 |      1024 |       8 | 24.28       | 345.16        | 168707               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       4 |      1024 |      16 | 20.41       | 673.16        | 200730               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       4 |      2048 |       8 | 43.30       | 1185.16       | 189176               | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       4 |      2048 |      16 | 104.21      | 2352.16       | 78614                | ✓        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       4 |      4096 |       8 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+
| ring_v2            |       4 |      4096 |      16 | N/A         | N/A           | N/A                  | ✗        |
+--------------------+---------+-----------+---------+-------------+---------------+----------------------+----------+