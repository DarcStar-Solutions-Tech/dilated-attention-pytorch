{
  "metadata": {
    "timestamp": "2025-07-07-0044-UTC",
    "device": "cuda",
    "gpu_name": "NVIDIA GeForce GTX 1080",
    "dtype": "float32",
    "pytorch_version": "2.7.1+cu126",
    "description": "Benchmarks of Ring/Hilbert implementations with standardized API"
  },
  "benchmarks": [
    {
      "config": {
        "batch_size": 2,
        "seq_len": 1024,
        "num_heads": 8,
        "head_dim": 64,
        "embed_dim": 512
      },
      "results": {
        "RingDilatedAttentionProduction-Fixed": {
          "implementation": "RingDilatedAttentionProduction-Fixed",
          "batch_size": 2,
          "seq_len": 1024,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 1.982460729777813,
            "std_ms": 0.4232733146266365,
            "min_ms": 1.631271094083786,
            "max_ms": 3.1212158501148224,
            "median_ms": 1.8272604793310165
          },
          "memory": {
            "start_mb": 12.0,
            "peak_mb": 53.12890625,
            "final_mb": 23.12890625,
            "delta_mb": 41.12890625
          },
          "throughput": {
            "tokens_per_second": 1033059,
            "sequences_per_second": 504.42361100997766
          }
        },
        "RingDilatedAttentionHybrid-Fixed": {
          "error": "The size of tensor a (512) must match the size of tensor b (256) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHybrid-Fixed"
        },
        "RingDilatedAttentionHilbert-Fixed": {
          "error": "The size of tensor a (512) must match the size of tensor b (256) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHilbert-Fixed"
        },
        "BlockSparseRingDilated-Fixed": {
          "implementation": "BlockSparseRingDilated-Fixed",
          "batch_size": 2,
          "seq_len": 1024,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 11.207985132932663,
            "std_ms": 1.986929398231938,
            "min_ms": 8.86517483741045,
            "max_ms": 15.305008739233017,
            "median_ms": 10.581285692751408
          },
          "memory": {
            "start_mb": 21.14453125,
            "peak_mb": 33.6455078125,
            "final_mb": 25.14453125,
            "delta_mb": 12.5009765625
          },
          "throughput": {
            "tokens_per_second": 182726,
            "sequences_per_second": 89.22210264730622
          }
        },
        "Factory-Production": {
          "implementation": "Factory-Production",
          "batch_size": 2,
          "seq_len": 1024,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 1.8716489896178246,
            "std_ms": 0.25759111486016656,
            "min_ms": 1.5643546357750893,
            "max_ms": 2.360849641263485,
            "median_ms": 1.8129008822143078
          },
          "memory": {
            "start_mb": 21.14453125,
            "peak_mb": 54.1484375,
            "final_mb": 24.1484375,
            "delta_mb": 33.00390625
          },
          "throughput": {
            "tokens_per_second": 1094222,
            "sequences_per_second": 534.2882161917507
          }
        }
      }
    },
    {
      "config": {
        "batch_size": 2,
        "seq_len": 2048,
        "num_heads": 8,
        "head_dim": 64,
        "embed_dim": 512
      },
      "results": {
        "RingDilatedAttentionProduction-Fixed": {
          "implementation": "RingDilatedAttentionProduction-Fixed",
          "batch_size": 2,
          "seq_len": 2048,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 5.214252509176731,
            "std_ms": 0.3172642804921342,
            "min_ms": 4.731064662337303,
            "max_ms": 5.7743508368730545,
            "median_ms": 5.212387070059776
          },
          "memory": {
            "start_mb": 32.125,
            "peak_mb": 130.1328125,
            "final_mb": 38.1328125,
            "delta_mb": 98.0078125
          },
          "throughput": {
            "tokens_per_second": 785539,
            "sequences_per_second": 191.78204320563069
          }
        },
        "RingDilatedAttentionHybrid-Fixed": {
          "error": "The size of tensor a (1024) must match the size of tensor b (512) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHybrid-Fixed"
        },
        "RingDilatedAttentionHilbert-Fixed": {
          "error": "The size of tensor a (1024) must match the size of tensor b (512) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHilbert-Fixed"
        },
        "BlockSparseRingDilated-Fixed": {
          "implementation": "BlockSparseRingDilated-Fixed",
          "batch_size": 2,
          "seq_len": 2048,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 21.344714146107435,
            "std_ms": 1.396062066196377,
            "min_ms": 18.535517156124115,
            "max_ms": 23.084103129804134,
            "median_ms": 21.559085231274366
          },
          "memory": {
            "start_mb": 34.1640625,
            "peak_mb": 54.666015625,
            "final_mb": 42.1640625,
            "delta_mb": 20.501953125
          },
          "throughput": {
            "tokens_per_second": 191897,
            "sequences_per_second": 46.85000666464145
          }
        },
        "Factory-Production": {
          "implementation": "Factory-Production",
          "batch_size": 2,
          "seq_len": 2048,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 4.995938576757908,
            "std_ms": 0.43104009899192725,
            "min_ms": 4.340042360126972,
            "max_ms": 5.587593652307987,
            "median_ms": 5.0833323039114475
          },
          "memory": {
            "start_mb": 34.1640625,
            "peak_mb": 132.171875,
            "final_mb": 40.171875,
            "delta_mb": 98.0078125
          },
          "throughput": {
            "tokens_per_second": 819865,
            "sequences_per_second": 200.16258899823094
          }
        }
      }
    },
    {
      "config": {
        "batch_size": 2,
        "seq_len": 4096,
        "num_heads": 8,
        "head_dim": 64,
        "embed_dim": 512
      },
      "results": {
        "RingDilatedAttentionProduction-Fixed": {
          "implementation": "RingDilatedAttentionProduction-Fixed",
          "batch_size": 2,
          "seq_len": 4096,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 91.57711155712605,
            "std_ms": 121.54194118118912,
            "min_ms": 16.39249548316002,
            "max_ms": 387.1642090380192,
            "median_ms": 25.00465279445052
          },
          "memory": {
            "start_mb": 56.125,
            "peak_mb": 380.140625,
            "final_mb": 68.140625,
            "delta_mb": 324.015625
          },
          "throughput": {
            "tokens_per_second": 89454,
            "sequences_per_second": 10.91975912972749
          }
        },
        "RingDilatedAttentionHybrid-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHybrid-Fixed"
        },
        "RingDilatedAttentionHilbert-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHilbert-Fixed"
        },
        "BlockSparseRingDilated-Fixed": {
          "implementation": "BlockSparseRingDilated-Fixed",
          "batch_size": 2,
          "seq_len": 4096,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 48.253557085990906,
            "std_ms": 5.149879085788774,
            "min_ms": 41.538892313838005,
            "max_ms": 57.69497435539961,
            "median_ms": 48.144467640668154
          },
          "memory": {
            "start_mb": 60.203125,
            "peak_mb": 96.7060546875,
            "final_mb": 76.203125,
            "delta_mb": 36.5029296875
          },
          "throughput": {
            "tokens_per_second": 169769,
            "sequences_per_second": 20.72386079678927
          }
        },
        "Factory-Production": {
          "implementation": "Factory-Production",
          "batch_size": 2,
          "seq_len": 4096,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 76.74078987911344,
            "std_ms": 18.709387192722723,
            "min_ms": 53.22910379618406,
            "max_ms": 117.36417654901743,
            "median_ms": 73.06090788915753
          },
          "memory": {
            "start_mb": 60.203125,
            "peak_mb": 384.21875,
            "final_mb": 72.21875,
            "delta_mb": 324.015625
          },
          "throughput": {
            "tokens_per_second": 106748,
            "sequences_per_second": 13.03087968699903
          }
        }
      }
    },
    {
      "config": {
        "batch_size": 1,
        "seq_len": 8192,
        "num_heads": 8,
        "head_dim": 64,
        "embed_dim": 512
      },
      "results": {
        "RingDilatedAttentionProduction-Fixed": {
          "implementation": "RingDilatedAttentionProduction-Fixed",
          "batch_size": 1,
          "seq_len": 8192,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 30.44377528131008,
            "std_ms": 2.4083421133397187,
            "min_ms": 26.81313082575798,
            "max_ms": 35.74620559811592,
            "median_ms": 30.10673727840185
          },
          "memory": {
            "start_mb": 56.125,
            "peak_mb": 380.140625,
            "final_mb": 68.140625,
            "delta_mb": 324.015625
          },
          "throughput": {
            "tokens_per_second": 269086,
            "sequences_per_second": 32.84743730893047
          }
        },
        "RingDilatedAttentionHybrid-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHybrid-Fixed"
        },
        "RingDilatedAttentionHilbert-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHilbert-Fixed"
        },
        "BlockSparseRingDilated-Fixed": {
          "implementation": "BlockSparseRingDilated-Fixed",
          "batch_size": 1,
          "seq_len": 8192,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 85.39118831977248,
            "std_ms": 8.906730740187994,
            "min_ms": 73.710136115551,
            "max_ms": 104.90045510232449,
            "median_ms": 83.57821684330702
          },
          "memory": {
            "start_mb": 60.265625,
            "peak_mb": 94.5205078125,
            "final_mb": 76.265625,
            "delta_mb": 34.2548828125
          },
          "throughput": {
            "tokens_per_second": 95934,
            "sequences_per_second": 11.710810209774868
          }
        },
        "Factory-Production": {
          "implementation": "Factory-Production",
          "batch_size": 1,
          "seq_len": 8192,
          "num_heads": 8,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 92.24241711199284,
            "std_ms": 58.056172895492836,
            "min_ms": 34.37949903309345,
            "max_ms": 173.61734807491302,
            "median_ms": 60.09355979040265
          },
          "memory": {
            "start_mb": 60.265625,
            "peak_mb": 384.28125,
            "final_mb": 72.28125,
            "delta_mb": 324.015625
          },
          "throughput": {
            "tokens_per_second": 88809,
            "sequences_per_second": 10.84099952395963
          }
        }
      }
    },
    {
      "config": {
        "batch_size": 2,
        "seq_len": 4096,
        "num_heads": 4,
        "head_dim": 64,
        "embed_dim": 256
      },
      "results": {
        "RingDilatedAttentionProduction-Fixed": {
          "implementation": "RingDilatedAttentionProduction-Fixed",
          "batch_size": 2,
          "seq_len": 4096,
          "num_heads": 4,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 11.787980236113071,
            "std_ms": 2.7630406952026694,
            "min_ms": 8.696197532117367,
            "max_ms": 18.48651561886072,
            "median_ms": 11.229909025132656
          },
          "memory": {
            "start_mb": 32.125,
            "peak_mb": 194.140625,
            "final_mb": 38.140625,
            "delta_mb": 162.015625
          },
          "throughput": {
            "tokens_per_second": 694945,
            "sequences_per_second": 84.83217480603247
          }
        },
        "RingDilatedAttentionHybrid-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHybrid-Fixed"
        },
        "RingDilatedAttentionHilbert-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHilbert-Fixed"
        },
        "BlockSparseRingDilated-Fixed": {
          "implementation": "BlockSparseRingDilated-Fixed",
          "batch_size": 2,
          "seq_len": 4096,
          "num_heads": 4,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 52.96856481581926,
            "std_ms": 18.1741289808673,
            "min_ms": 39.90131989121437,
            "max_ms": 105.16522638499737,
            "median_ms": 48.09539671987295
          },
          "memory": {
            "start_mb": 34.203125,
            "peak_mb": 52.4560546875,
            "final_mb": 42.203125,
            "delta_mb": 18.2529296875
          },
          "throughput": {
            "tokens_per_second": 154657,
            "sequences_per_second": 18.879122050543952
          }
        },
        "Factory-Production": {
          "implementation": "Factory-Production",
          "batch_size": 2,
          "seq_len": 4096,
          "num_heads": 4,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 10.592717491090298,
            "std_ms": 2.7720226747064562,
            "min_ms": 8.326361887156963,
            "max_ms": 17.71804504096508,
            "median_ms": 9.539890568703413
          },
          "memory": {
            "start_mb": 34.203125,
            "peak_mb": 196.21875,
            "final_mb": 40.21875,
            "delta_mb": 162.015625
          },
          "throughput": {
            "tokens_per_second": 773361,
            "sequences_per_second": 94.40448127131832
          }
        }
      }
    },
    {
      "config": {
        "batch_size": 2,
        "seq_len": 4096,
        "num_heads": 16,
        "head_dim": 64,
        "embed_dim": 1024
      },
      "results": {
        "RingDilatedAttentionProduction-Fixed": {
          "implementation": "RingDilatedAttentionProduction-Fixed",
          "batch_size": 2,
          "seq_len": 4096,
          "num_heads": 16,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 199.6041919104755,
            "std_ms": 161.16859756059813,
            "min_ms": 78.9955398067832,
            "max_ms": 541.8745437636971,
            "median_ms": 122.93155025690794
          },
          "memory": {
            "start_mb": 104.125,
            "peak_mb": 752.140625,
            "final_mb": 128.140625,
            "delta_mb": 648.015625
          },
          "throughput": {
            "tokens_per_second": 41041,
            "sequences_per_second": 5.00991482407599
          }
        },
        "RingDilatedAttentionHybrid-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHybrid-Fixed"
        },
        "RingDilatedAttentionHilbert-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHilbert-Fixed"
        },
        "BlockSparseRingDilated-Fixed": {
          "implementation": "BlockSparseRingDilated-Fixed",
          "batch_size": 2,
          "seq_len": 4096,
          "num_heads": 16,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 101.38804875314236,
            "std_ms": 93.83066410042683,
            "min_ms": 49.1225142031908,
            "max_ms": 378.3429805189371,
            "median_ms": 72.14934704825282
          },
          "memory": {
            "start_mb": 112.203125,
            "peak_mb": 185.2060546875,
            "final_mb": 144.203125,
            "delta_mb": 73.0029296875
          },
          "throughput": {
            "tokens_per_second": 80798,
            "sequences_per_second": 9.863095426905597
          }
        },
        "Factory-Production": {
          "implementation": "Factory-Production",
          "batch_size": 2,
          "seq_len": 4096,
          "num_heads": 16,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 76.64744611829519,
            "std_ms": 23.167088744152554,
            "min_ms": 58.37855488061905,
            "max_ms": 136.8603566661477,
            "median_ms": 67.59561970829964
          },
          "memory": {
            "start_mb": 112.203125,
            "peak_mb": 760.21875,
            "final_mb": 136.21875,
            "delta_mb": 648.015625
          },
          "throughput": {
            "tokens_per_second": 106878,
            "sequences_per_second": 13.046749117467428
          }
        }
      }
    },
    {
      "config": {
        "batch_size": 1,
        "seq_len": 4096,
        "num_heads": 12,
        "head_dim": 64,
        "embed_dim": 768
      },
      "results": {
        "RingDilatedAttentionProduction-Fixed": {
          "implementation": "RingDilatedAttentionProduction-Fixed",
          "batch_size": 1,
          "seq_len": 4096,
          "num_heads": 12,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 72.56169635802507,
            "std_ms": 31.68347733226197,
            "min_ms": 19.457709975540638,
            "max_ms": 120.50539255142212,
            "median_ms": 91.596401296556
          },
          "memory": {
            "start_mb": 44.125,
            "peak_mb": 288.140625,
            "final_mb": 53.140625,
            "delta_mb": 244.015625
          },
          "throughput": {
            "tokens_per_second": 56448,
            "sequences_per_second": 13.781375714618385
          }
        },
        "RingDilatedAttentionHybrid-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHybrid-Fixed"
        },
        "RingDilatedAttentionHilbert-Fixed": {
          "error": "The size of tensor a (2048) must match the size of tensor b (1024) at non-singleton dimension 1",
          "name": "RingDilatedAttentionHilbert-Fixed"
        },
        "BlockSparseRingDilated-Fixed": {
          "implementation": "BlockSparseRingDilated-Fixed",
          "batch_size": 1,
          "seq_len": 4096,
          "num_heads": 12,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 37.736834306269884,
            "std_ms": 2.2207351604944354,
            "min_ms": 34.288481809198856,
            "max_ms": 41.89547896385193,
            "median_ms": 37.60191658511758
          },
          "memory": {
            "start_mb": 47.203125,
            "peak_mb": 74.5810546875,
            "final_mb": 59.203125,
            "delta_mb": 27.3779296875
          },
          "throughput": {
            "tokens_per_second": 108541,
            "sequences_per_second": 26.49930812648618
          }
        },
        "Factory-Production": {
          "implementation": "Factory-Production",
          "batch_size": 1,
          "seq_len": 4096,
          "num_heads": 12,
          "head_dim": 64,
          "dtype": "float32",
          "timing": {
            "mean_ms": 74.16159687563777,
            "std_ms": 80.47231008237468,
            "min_ms": 27.171163819730282,
            "max_ms": 299.68769289553165,
            "median_ms": 37.341608200222254
          },
          "memory": {
            "start_mb": 47.203125,
            "peak_mb": 291.21875,
            "final_mb": 56.21875,
            "delta_mb": 244.015625
          },
          "throughput": {
            "tokens_per_second": 55230,
            "sequences_per_second": 13.484067794237342
          }
        }
      }
    }
  ]
}