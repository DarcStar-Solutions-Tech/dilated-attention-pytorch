{
  "config": {
    "device": "cuda",
    "dtype": "torch.float32",
    "benchmark_config": {
      "batch_sizes": [
        1,
        2
      ],
      "seq_lengths": [
        512,
        1024
      ],
      "num_heads_list": [
        8,
        16
      ],
      "head_dim": 64,
      "segment_lengths": [
        [
          512,
          1024
        ],
        [
          1024,
          2048
        ],
        [
          2048,
          4096
        ]
      ],
      "dilation_rates": [
        [
          1,
          2
        ],
        [
          1,
          2
        ],
        [
          1,
          2
        ]
      ],
      "warmup_steps": 3,
      "benchmark_steps": 10,
      "device": "cuda",
      "use_fp16": true,
      "use_memory_pool": true,
      "memory_pool_size": null,
      "use_pattern_cache": true,
      "pattern_cache_size": 100,
      "save_plots": true,
      "save_csv": true,
      "verbose": true
    }
  },
  "results": [
    {
      "implementation": "standard",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 0.5626748315989971,
      "memory_mb": 22.0390625,
      "throughput": 909939.4023809622,
      "success": true,
      "error": null
    },
    {
      "implementation": "standard",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.780902523547411,
      "memory_mb": 33.0390625,
      "throughput": 655651.6140761516,
      "success": true,
      "error": null
    },
    {
      "implementation": "standard",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 1.168187614530325,
      "memory_mb": 33.0390625,
      "throughput": 876571.5260657885,
      "success": true,
      "error": null
    },
    {
      "implementation": "standard",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 2.090561203658581,
      "memory_mb": 53.0390625,
      "throughput": 489820.6272114644,
      "success": true,
      "error": null
    },
    {
      "implementation": "standard",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 0.7877272553741932,
      "memory_mb": 33.0390625,
      "throughput": 1299942.3252323172,
      "success": true,
      "error": null
    },
    {
      "implementation": "standard",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 1.165710762143135,
      "memory_mb": 53.0390625,
      "throughput": 878434.0277663708,
      "success": true,
      "error": null
    },
    {
      "implementation": "standard",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 1.9215619191527367,
      "memory_mb": 53.0390625,
      "throughput": 1065799.6391305532,
      "success": true,
      "error": null
    },
    {
      "implementation": "standard",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 3.105329815298319,
      "memory_mb": 93.0390625,
      "throughput": 659511.2666972076,
      "success": true,
      "error": null
    },
    {
      "implementation": "improved",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 0.3192320466041565,
      "memory_mb": 20.0390625,
      "throughput": 1603849.0040283243,
      "success": true,
      "error": null
    },
    {
      "implementation": "improved",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.3889811225235462,
      "memory_mb": 29.0390625,
      "throughput": 1316259.2484652183,
      "success": true,
      "error": null
    },
    {
      "implementation": "improved",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 0.6791104562580585,
      "memory_mb": 29.0390625,
      "throughput": 1507854.8571351774,
      "success": true,
      "error": null
    },
    {
      "implementation": "improved",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.6168383173644543,
      "memory_mb": 45.0390625,
      "throughput": 1660078.4535811795,
      "success": true,
      "error": null
    },
    {
      "implementation": "improved",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 0.4939776845276356,
      "memory_mb": 29.0390625,
      "throughput": 2072968.1361602324,
      "success": true,
      "error": null
    },
    {
      "implementation": "improved",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.6216363050043583,
      "memory_mb": 45.0390625,
      "throughput": 1647265.4376143953,
      "success": true,
      "error": null
    },
    {
      "implementation": "improved",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 0.8708972483873367,
      "memory_mb": 45.0390625,
      "throughput": 2351597.738760038,
      "success": true,
      "error": null
    },
    {
      "implementation": "improved",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.9338401257991791,
      "memory_mb": 77.0390625,
      "throughput": 2193094.881468415,
      "success": true,
      "error": null
    },
    {
      "implementation": "multihead_standard",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 0.8083073422312737,
      "memory_mb": 33.1640625,
      "throughput": 633422.4288828816,
      "success": true,
      "error": null
    },
    {
      "implementation": "multihead_standard",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "Input embedding dimension (1024) doesn't match expected (512)"
    },
    {
      "implementation": "multihead_standard",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 1.090205553919077,
      "memory_mb": 47.0390625,
      "throughput": 939272.411811625,
      "success": true,
      "error": null
    },
    {
      "implementation": "multihead_standard",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "Input embedding dimension (1024) doesn't match expected (512)"
    },
    {
      "implementation": "multihead_standard",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 1.0735665448009968,
      "memory_mb": 47.0390625,
      "throughput": 953830.0210256786,
      "success": true,
      "error": null
    },
    {
      "implementation": "multihead_standard",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "Input embedding dimension (1024) doesn't match expected (512)"
    },
    {
      "implementation": "multihead_standard",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 1.794264279305935,
      "memory_mb": 73.0390625,
      "throughput": 1141414.9095094376,
      "success": true,
      "error": null
    },
    {
      "implementation": "multihead_standard",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "Input embedding dimension (1024) doesn't match expected (512)"
    },
    {
      "implementation": "multihead_improved",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 0.9164766408503056,
      "memory_mb": 40.1640625,
      "throughput": 558661.2655233277,
      "success": true,
      "error": null
    },
    {
      "implementation": "multihead_improved",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "mat1 and mat2 shapes cannot be multiplied (512x1024 and 512x1536)"
    },
    {
      "implementation": "multihead_improved",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 1.6472391784191132,
      "memory_mb": 63.0390625,
      "throughput": 621646.214718346,
      "success": true,
      "error": null
    },
    {
      "implementation": "multihead_improved",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "mat1 and mat2 shapes cannot be multiplied (1024x1024 and 512x1536)"
    },
    {
      "implementation": "multihead_improved",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 1.9652246497571468,
      "memory_mb": 61.0390625,
      "throughput": 521060.0223880466,
      "success": true,
      "error": null
    },
    {
      "implementation": "multihead_improved",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "mat1 and mat2 shapes cannot be multiplied (1024x1024 and 512x1536)"
    },
    {
      "implementation": "multihead_improved",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 5.110774002969265,
      "memory_mb": 105.0390625,
      "throughput": 400722.0821758407,
      "success": true,
      "error": null
    },
    {
      "implementation": "multihead_improved",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "mat1 and mat2 shapes cannot be multiplied (2048x1024 and 512x1536)"
    },
    {
      "implementation": "ring_v2_collective",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 0.5934094078838825,
      "memory_mb": 45.0390625,
      "throughput": 862810.7225765241,
      "success": true,
      "error": null
    },
    {
      "implementation": "ring_v2_collective",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 1.0158661752939224,
      "memory_mb": 69.0390625,
      "throughput": 504003.3938051556,
      "success": true,
      "error": null
    },
    {
      "implementation": "ring_v2_collective",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 2.182335965335369,
      "memory_mb": 101.0390625,
      "throughput": 469221.9787720162,
      "success": true,
      "error": null
    },
    {
      "implementation": "ring_v2_collective",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 3.7872780114412308,
      "memory_mb": 181.0390625,
      "throughput": 270378.8834372689,
      "success": true,
      "error": null
    },
    {
      "implementation": "ring_v2_collective",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 1.4209718443453312,
      "memory_mb": 71.0390625,
      "throughput": 720633.5608090647,
      "success": true,
      "error": null
    },
    {
      "implementation": "ring_v2_collective",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 2.238318510353565,
      "memory_mb": 121.0390625,
      "throughput": 457486.2760877802,
      "success": true,
      "error": null
    },
    {
      "implementation": "ring_v2_collective",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 4.071601014584303,
      "memory_mb": 185.0390625,
      "throughput": 502996.2397258844,
      "success": true,
      "error": null
    },
    {
      "implementation": "ring_v2_collective",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 12.91335066780448,
      "memory_mb": 349.0390625,
      "throughput": 158595.55375554593,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 3.359211888164282,
      "memory_mb": 29.4150390625,
      "throughput": 152416.70279983265,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 3.0425445176661015,
      "memory_mb": 39.5400390625,
      "throughput": 168280.2000191435,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 5.619241110980511,
      "memory_mb": 37.2900390625,
      "throughput": 182231.01300974796,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 6.492055114358664,
      "memory_mb": 53.5400390625,
      "throughput": 157731.2548895634,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 2.795487642288208,
      "memory_mb": 39.5400390625,
      "throughput": 366304.6062195499,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 4.6193731017410755,
      "memory_mb": 58.0400390625,
      "throughput": 221675.10124134526,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 6.062731519341469,
      "memory_mb": 53.5400390625,
      "throughput": 337801.53276892146,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 10.791509319096804,
      "memory_mb": 86.0400390625,
      "throughput": 189778.82884054328,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse_multihead",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 3.5033484920859337,
      "memory_mb": 32.4150390625,
      "throughput": 146145.89475086716,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse_multihead",
      "batch_size": 1,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "mat1 and mat2 shapes cannot be multiplied (512x1024 and 512x512)"
    },
    {
      "implementation": "block_sparse_multihead",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 7.051027752459049,
      "memory_mb": 44.0390625,
      "throughput": 145227.05567892277,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse_multihead",
      "batch_size": 1,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "mat1 and mat2 shapes cannot be multiplied (1024x1024 and 512x512)"
    },
    {
      "implementation": "block_sparse_multihead",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 4.082897864282131,
      "memory_mb": 45.5400390625,
      "throughput": 250802.25713166184,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse_multihead",
      "batch_size": 2,
      "seq_length": 512,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "mat1 and mat2 shapes cannot be multiplied (1024x1024 and 512x512)"
    },
    {
      "implementation": "block_sparse_multihead",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 8,
      "head_dim": 64,
      "time_ms": 7.965885661542416,
      "memory_mb": 66.0390625,
      "throughput": 257096.33391893937,
      "success": true,
      "error": null
    },
    {
      "implementation": "block_sparse_multihead",
      "batch_size": 2,
      "seq_length": 1024,
      "num_heads": 16,
      "head_dim": 64,
      "time_ms": 0.0,
      "memory_mb": 0.0,
      "throughput": 0.0,
      "success": false,
      "error": "mat1 and mat2 shapes cannot be multiplied (2048x1024 and 512x512)"
    }
  ],
  "timestamp": "20250630_120426"
}